# Журнал изменений

## [2.3.3] - 2024-06-25
### Добавлено
- **Проверка работоспособности системы**:
  - Добавлена функция для обнаружения неработающих (`failed`) системных служб с возможностью их немедленного перезапуска.
  - Добавлена функция для анализа системного журнала (`journalctl`) на наличие критических ошибок за последние 24 часа.
- **Аудит безопасности**:
  - В "Быстрые проверки" добавлена новая функция для поиска файлов и директорий, доступных для записи всем пользователям (`world-writable`), что является потенциальной уязвимостью.
  - Добавлен новый глубокий аудит с использованием `rkhunter` для сканирования системы на наличие руткитов. Включает автоматическую установку `rkhunter`, если он отсутствует.

### Изменено
- Меню в модулях "Проверка работоспособности" и "Аудит безопасности" были обновлены для включения новых проверок.
- Глубокий аудит теперь разделен на `Lynis` и `rkhunter` для большей ясности.

## [2.3.1] - 2024-06-25
### Добавлено
- **Менеджер бэкапов**:
  - Новый модуль (`backup.py`) добавлен в главное меню.
  - Возможность создавать бэкапы отдельных файлов или целых директорий в виде архива `.tar.gz`.
  - Возможность создавать бэкапы баз данных MySQL с помощью `mysqldump` и сохранять их в сжатом формате `.sql.gz`.
  - Возможность просмотра списка существующих бэкапов в указанной директории.

### Исправлено
- **Обновление**: Исправлена критическая ошибка `KeyError: 'version'`, которая возникала в модуле обновления (`updater.py`), если `CHANGELOG.md` не содержал секции `[Unreleased]`. Теперь парсер корректно обрабатывает лог, даже если эта секция отсутствует.

## [2.3.0] - 2024-06-25

### Добавлено
- **Менеджер веб-сервера**: Крупный новый модуль для управления веб-сервером.
  - Автоматически определяет установленные серверы (Nginx, Apache).
  - Позволяет выбрать, каким сервером управлять, если установлены оба.
- **Поддержка Nginx**:
  - Создание простых статичных сайтов HTML.
  - Создание и развертывание приложений Next.js с PM2 и обратным прокси.
  - Создание сайтов на PHP с автоматической настройкой PHP-FPM.
- **Поддержка Apache**:
  - Создание простых статичных сайтов HTML.
  - Создание сайтов на PHP с автоматической настройкой PHP-FPM (`proxy_fcgi`).
  - *Поддержка Next.js для Apache планируется в будущем.*
- **Управление SSL (Let's Encrypt)**:
  - Интегрирована поддержка `certbot`.
  - Опция для запроса и установки бесплатного SSL-сертификата после создания любого сайта.
  - Автоматическая настройка HTTPS-редиректа.
  - Отдельное меню для просмотра и тестирования продления существующих сертификатов.

### Изменено
- Проведен рефакторинг всего модуля `web_server.py` для поддержки нескольких веб-серверов.
- В главном меню теперь условно отображается опция "Менеджер веб-сервера".

---

## [2.2.5] - 2024-06-24

### Добавлено
- **Менеджер ПО**: Добавлена возможность полного удаления WireGuard (пакет `wireguard-tools`) через интерфейс менеджера.

## [2.2.4] - 2024-06-24

### Исправлено
- **Локализация**: Добавлены недостающие русские и английские переводы для функции управления Webmin и для общих действий и статусов управления службами.

## [2.2.3] - 2024-06-24

### Добавлено
- **Менеджер ПО**:
    - Добавлено комплексное управление для **Webmin**. Включает в себя установщик с настройкой официального репозитория, деинсталлятор и меню управления для контроля службы `webmin` и просмотра URL-адреса доступа.

### Изменено
- **Крупный рефакторинг (Службы и ПО)**:
    - Управление **WireGuard** было логически перенесено из "Менеджера служб" в "Менеджер ПО" для большей согласованности.
    - Модуль "Менеджер служб" был упрощен. Теперь он не содержит специфической логики приложений и служит в качестве универсального просмотрщика статуса всех служб `systemd`.
- **Обновление**:
    - Механизм проверки обновлений был значительно улучшен. Теперь он парсит `CHANGELOG.md` и отображает заметки только для последней доступной версии, а не весь файл.

## [2.2.2] - 2024-06-23

### Добавлено
- **Инструменты разработчика**:
    - Значительно расширен модуль "Инструменты разработчика".
    - Добавлен комплексный менеджер для **Node.js** с использованием **NVM**.
    - Панель теперь может устанавливать NVM, если он отсутствует.
    - Реализованы функции для установки различных версий Node.js и просмотра установленных версий.
    - Добавлена прямая опция для установки или обновления **PM2** глобально через NPM.
- **Возможности Менеджера ПО**:
    - **Nginx**: Добавлена функция для вывода списка всех настроенных сайтов из `/etc/nginx/sites-enabled`.
    - **MySQL & PostgreSQL**: Добавлена возможность вывода списка всех баз данных.
    - **Certbot**: Добавлена функция для вывода списка всех существующих SSL-сертификатов.
    - **Fail2Ban**: Добавлена полная поддержка управления, включая просмотр "тюрем", проверку статуса и утилиту для разбана IP-адресов.
    - **Docker Compose**: Добавлена поддержка установки Docker Compose.
- **Модуль Docker**:
    - Интегрировано управление **Docker Compose** непосредственно в модуль Docker.
    - Пользователи теперь могут указать на директорию проекта и выполнять команды `up`, `down`, `ps` и `logs` для файла `docker-compose.yml`.
- **Nextcloud**: Подготовлена основа для будущего "Мастера установки Nextcloud" с пунктом меню-заполнителем.

### Изменено
- **UI/UX**:
    - Меню Менеджера ПО стало более информативным. Оно отображает префиксы `[Управлять]` или `[Установить]`.
    - Для установленного ПО панель теперь пытается определить и отобразить текущую версию (например, `Nginx (v1.18.0)`).
- **Структура кода**: Модуль "Инструменты разработчика" теперь является специальным местом для управления средами разработки, такими как Node.js и Java.

### Исправлено
- **Обнаружение 3X-UI**: Исправлен путь к файлу, используемый для проверки существующей установки 3X-UI. Добавлена команда для получения его версии.

## [2.2.1] - 2024-06-22

### Добавлено
- **Главная функция: Менеджер ПО**: Новый централизованный модуль (`app/modules/software_manager.py`) для установки и управления различными службами. Меню динамически показывает "Установить" или "Управлять" в зависимости от статуса установки ПО.
- **Nginx & Apache2**: Добавлена полная поддержка управления (статус, перезапуск, перезагрузка, тест конфигурации, удаление).
- **Базы данных**: Добавлено управление для **MySQL**, **PostgreSQL** и **MongoDB**.
- **Хранилище в памяти**: Добавлено управление для **Redis**.
- **Пользовательские установщики**:
    - **3X-UI**: Добавлен пользовательский установщик и менеджер для панели 3X-UI.
    - **PHPMyAdmin**: Добавлен управляемый установщик с проверкой зависимостей.
    - **Certbot (Let's Encrypt)**: Добавлен установщик и менеджер для получения SSL-сертификатов с использованием плагина Nginx.
- **Утилиты**: Добавлена универсальная функция `is_tool_installed` в `app/utils.py` и улучшены проверки установки для поддержки как команд из PATH, так и прямых путей к файлам.
- **Локализация**: Добавлены десятки новых ключей перевода в `ru.json` и `en.json` для поддержки всех новых функций.

### Изменено
- **Главное меню**: В меню теперь есть пункт "Менеджер ПО", объединяющий все управление службами.
- **Менеджер PM2**: Пункт меню для менеджера PM2 теперь является условным и появляется только в том случае, если PM2 действительно установлен.
- **Структура кода**:
    - Старый `app/modules/web_server.py` был удален.
    - Логика для MySQL и PHPMyAdmin была перенесена из `dev_tools.py` в новый `software_manager.py`.
    - Модуль `dev_tools.py` теперь стал более компактным и содержит только установщик Java.

### Исправлено
- **Отсутствующая функциональность**: Повторно реализована утерянная функциональность "Менеджера MySQL" и значительно расширена.

## [2.1.4] - 2024-06-21

### Добавлено
- **Docker:** Реализован просмотр списка локальных Docker-образов.
- **Firewall:** Добавлена проверка статуса UFW и инструкции по установке, если он отсутствует.
- **Localization:** Добавлены многочисленные переводы для модулей Firewall, WireGuard, Network, Users и Docker.

### Изменено
- **UI:** Полностью переработан дизайн главного меню для более современного и удобного вида. Добавлен копирайт.
- **System Monitor:** Интерфейс полностью переделан, чтобы быть более похожим на `htop`, с единой таблицей процессов и наглядными индикаторами нагрузки вверху.
- **Updater:** Механизм обновления полностью переписан для использования GitHub API, что значительно повысило его надежность. Исправлена критическая ошибка, когда скрипт не мог обновиться.

### Исправлено
- **Cron:** Исправлена критическая ошибка, приводившая к падению приложения при входе в менеджер Cron.
- **Hardcoded Strings:** Заменены жестко закодированные строки на ключи локализации в модулях Network и Users.

## [2.0.0] - 2023-10-27

### Добавлено
- Полный рефакторинг проекта на модули.
- Выбор языка (английский/русский).
- Механизм самообновления через Git.
- Модули Docker, Services, Security, Health и Monitor.

### Изменено
- Улучшен пользовательский интерфейс с помощью `rich` и `questionary`.

## [1.0.0] - 2023-10-26

### Добавлено
- Первоначальный скрипт для управления сервером.
- Базовые проверки работоспособности и мониторинг системы. 